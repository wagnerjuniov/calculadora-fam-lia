<!DOCTYPE html>
<html lang="pt-BR" data-theme="light"> <!-- Define o tema inicial -->
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Calculadora da Família - Preview Tema Apple">
  <title>Calculadora da Família - Preview Tema</title>
  
  <!-- Fonte Inter via Google Fonts (Alternativa próxima à San Francisco) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  
  <!-- ===== INÍCIO: BLOCO 1 - CSS Essencial (Estilo Apple) ===== -->
  <style>
    /* Design-tokens em :root (Tema Claro por padrão) */
    :root {
      /* Cores Neutras (Light Mode) */
      --color-background: #ffffff; /* Branco puro */
      --color-surface-variant: #f0f0f0; /* Cinza muito claro para botões/elementos sutis */
      --color-on-surface: #1d1d1f; /* Preto/Cinza escuro para texto principal */
      --color-on-surface-variant: #6e6e73; /* Cinza médio para texto secundário/ícones */
      --color-outline: #d2d2d7; /* Cinza claro para bordas sutis (se necessário) */
      
      /* Tipografia */
      --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; /* Inter como fallback, -apple-system prioriza San Francisco */
      --font-size-md: 1rem; /* 16px ou 17px é comum na Apple */
      --font-size-xl: 1.75rem; /* Tamanho para H1 (ex: 28px) */
      --font-weight-regular: 400;
      --font-weight-semibold: 600; /* Usado no H1 */
      
      /* Espaçamento */
      --spacing-md: 1rem; /* 16px */
      --spacing-xl: 2rem; /* 32px */
      
      /* Bordas e Raios */
      --radius-full: 9999px; /* Para botões circulares */
      
      /* Animações */
      --transition-normal: 0.25s cubic-bezier(0.4, 0, 0.2, 1); /* Transição suave padrão */
    }
    
    /* Tema Escuro */
    [data-theme="dark"] {
      --color-background: #000000; /* Preto absoluto */
      --color-surface-variant: #333333; /* Cinza escuro para botões/elementos */
      --color-on-surface: #ffffff; /* Branco para texto principal */
      --color-on-surface-variant: #8e8e93; /* Cinza claro para texto secundário/ícones */
      --color-outline: #38383a; /* Cinza escuro para bordas sutis */
    }
    
    /* Reset Básico */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html, body {
      height: 100%;
      font-family: var(--font-family);
      background-color: var(--color-background);
      color: var(--color-on-surface);
      font-size: var(--font-size-md);
      line-height: 1.5; /* Espaçamento entre linhas */
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background-color var(--transition-normal), color var(--transition-normal);
      display: flex; /* Para centralizar conteúdo */
      align-items: center;
      justify-content: center;
      flex-direction: column; /* Empilha título e botão */
    }

    /* Container Simples (Opcional, ajuda a organizar) */
    .container {
       text-align: center;
       padding: var(--spacing-xl);
    }

    /* Estilo do Título (H1) */
    h1 {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-semibold);
      color: var(--color-on-surface); /* Usa a cor principal do texto do tema */
      margin-bottom: var(--spacing-xl); /* Espaço abaixo do título */
      transition: color var(--transition-normal); /* Anima a troca de cor */
    }
    
    /* Estilo do Botão de Tema */
    .theme-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 44px; /* Tamanho comum para botões de toque */
      height: 44px;
      border-radius: var(--radius-full); /* Totalmente redondo */
      cursor: pointer;
      background-color: var(--color-surface-variant); /* Fundo sutil */
      border: 1px solid var(--color-outline); /* Borda muito sutil */
      transition: background-color var(--transition-normal), border-color var(--transition-normal);
    }

    .theme-toggle:hover {
        filter: brightness(0.9); /* Escurece um pouco no hover */
    }
    
    .theme-toggle .icon-sun,
    .theme-toggle .icon-moon {
      width: 22px; /* Tamanho do ícone */
      height: 22px;
      color: var(--color-on-surface-variant); /* Cor do ícone */
      transition: color var(--transition-normal);
    }
    
    /* Esconder o ícone não ativo baseado no tema */
    [data-theme="light"] .theme-toggle .icon-moon {
      display: none;
    }
    
    [data-theme="dark"] .theme-toggle .icon-sun {
      display: none;
    }

    /* Classe auxiliar para forçar recálculo de cores (se necessário) */
    [data-recolor] {
      color: var(--color-on-surface);
      transition: color var(--transition-normal);
    }
  </style>
  <!-- ===== FIM: BLOCO 1 - CSS Essencial (Estilo Apple) ===== -->

</head>
<body>
  <!-- ===== INÍCIO: BLOCO 2 - SVG Sprite (Apenas Ícones de Tema) ===== -->
  <svg style="display: none;">
    <symbol id="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
    </symbol>
    <symbol id="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
    </symbol>
  </svg>
  <!-- ===== FIM: BLOCO 2 - SVG Sprite (Apenas Ícones de Tema) ===== -->

  <!-- ===== INÍCIO: BLOCO 3 - Conteúdo do Preview ===== -->
  <div class="container">
    <h1 data-recolor>Calculadora da Família</h1>
    
    <div id="themeToggle" class="theme-toggle" role="button" aria-label="Alternar tema">
      <svg class="icon-sun" width="22" height="22">
        <use href="#icon-sun"></use>
      </svg>
      <svg class="icon-moon" width="22" height="22">
        <use href="#icon-moon"></use>
      </svg>
    </div>
  </div>
  <!-- ===== FIM: BLOCO 3 - Conteúdo do Preview ===== -->

  <!-- ===== INÍCIO: BLOCO 4 - JavaScript Mínimo (Toggle Tema) ===== -->
  <script>
    // Helper DOM Simples
    const $ = selector => document.querySelector(selector);
    
    // Função de tema claro/escuro
    const toggleTheme = () => {
      const htmlElement = document.documentElement;
      const currentTheme = htmlElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      
      htmlElement.setAttribute('data-theme', newTheme);
      // Armazenar preferência em localStorage para persistência
      localStorage.setItem('themePreference', newTheme);

      // Força o navegador a recalcular estilos para elementos com data-recolor (opcional, mas bom para garantir transições)
       document.querySelectorAll('[data-recolor]').forEach(el => {
           el.style.transition = 'none'; // Desabilita transição temporariamente
           el.style.color = ''; // Força reavaliação da variável CSS
           // Força reflow (leitura de propriedade que depende do layout)
           void el.offsetWidth; 
           el.style.transition = ''; // Reabilita a transição
       });
    };
    
    // Inicializa o tema ao carregar a página
    const initTheme = () => {
      const savedTheme = localStorage.getItem('themePreference');
      // Verifica preferência do sistema se não houver tema salvo
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const initialTheme = savedTheme || (prefersDark ? 'dark' : 'light');
      
      document.documentElement.setAttribute('data-theme', initialTheme);
      
      // Adiciona listener ao botão de toggle
      const themeButton = $('#themeToggle');
      if (themeButton) {
          themeButton.addEventListener('click', toggleTheme);
      } else {
          console.error("Elemento #themeToggle não encontrado.");
      }
    };
    
    // Iniciar quando o DOM estiver pronto
    document.addEventListener('DOMContentLoaded', initTheme);
  </script>
  <!-- ===== FIM: BLOCO 4 - JavaScript Mínimo (Toggle Tema) ===== -->

</body>
</html>